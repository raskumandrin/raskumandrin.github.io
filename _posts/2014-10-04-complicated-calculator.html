---
url: complicated-calculator
title: Сложный калькулятор на JavaScript
excerpt: |
    <p>Ранее уже приводил пример <a href="/simple-calculator">простого калькулятора на JavaScript</a>, теперь вот пример посложнее.</p>
    <p style="text-align: center;"><a href="/complicated-calculator"><img style="border: solid 1px #f9f9f9; padding: 4px; border-radius: 3px;"  src="https://pub-3e57dc6805fe47c580cebfca6d4f2436.r2.dev/2014-10-04-complicated-calculator/calc.th2.png"></a></p>
    <p>Калькулятор требовался для автоматизации работы отдела продаж натяжных потолков.
    Алгоритм вычисления стоимости оказался весьма запутанным с большим числом зависимостей между параметрами.
    Кроме параметров самих потолков существовала ещё система скидок, которая переплетала
    промежуточные и конечные результаты вычислений.</p>

cuttitle: "Результат работы"
categories: work
tags: [javascript]

---
<p>Ранее уже приводил пример <a href="/simple-calculator">простого калькулятора на JavaScript</a>, теперь вот пример посложнее.</p>

<p>Калькулятор требовался для автоматизации работы отдела продаж натяжных потолков.
Алгоритм вычисления стоимости оказался весьма запутанным с большим числом зависимостей между параметрами.
Кроме параметров самих потолков существовала ещё система скидок, которая переплетала
промежуточные и конечные результаты вычислений.</p>

<p>К моменту постановки задачи вычисление стоимости набора потолков для одного
клиента могло занимать до получаса. Во-первых, это сильно тормозило
работу отдела продаж. Вторым негативным фактором была большая вероятность появления
ошибок в ручных вычислениях, что позднее влияло на лояльность со стороны клиентов.
Наконец, было очень тяжело обучить нового сотрудника особенностям вычислений и исключениям из правил.</p>

<p>Технических требований практически не было изначально. Точнее было мнение заказчика, что
неплохо бы это всё реализовать в Excel'е.</p>

<p>Я предложил вариант веб-версии калькулятора. В результате можно было избежать зависимостей от
конкретных версий Excel'я, сложностей установки на все компьютеры, поддержки актуальных обновлений
программной части, а так же легко реализовать единый массив посчитанных вариантов, который всем доступен.</p>

<p>Все вычисления было решено проводить на фронтенде JavaScropt'ом — это с одной стороны давало возможность
получать результат моментально, без отправки всего массива данных на сервер и анализа ответа; с другой стороны
это позволяло немного проще всем управлять, когда будут менять алгоритмы работы калькулятора.</p>

<p>В качестве интерфейса был выбран <a href="http://getbootstrap.com">Bootstrap</a>, что позволило вообще не
задумываться о дизайне отдельных элементов интерфейса, а полностью сконцентрироваться на программной части.</p>

<p>Итоговый вид калькулятора получился таким.</p>

<p style="text-align: center;"><a href="https://pub-3e57dc6805fe47c580cebfca6d4f2436.r2.dev/2014-10-04-complicated-calculator/calc.png"><img style="border: solid 1px #f9f9f9; padding: 4px; border-radius: 3px;"  src="https://pub-3e57dc6805fe47c580cebfca6d4f2436.r2.dev/2014-10-04-complicated-calculator/calc.th.png"></a></p>

<p>Исходные проблемы были устранены. Теперь требовалось только внести нужные цифры — все вычисления
	происходили сразу. Сотруднику отдела продаж не нужно было досконально разбираться в особенностях
	алгоритма. Для упрощения работы новым сотрудникам по каждому параметру были вынесены
	достаточно подробные всплывающие описания с упоминанием особенностей и исключений.</p>

<p style="font-size: 120%; color: #333;"><a href="https://pub-3e57dc6805fe47c580cebfca6d4f2436.r2.dev/2014-10-04-complicated-calculator/src/complicated-calculator-ru-layout.html">Pабочая интерактивная версия калькулятора натяжных потолков</a>.</p>

<p>В расчёте может быть несколько потолков, например для кухни, гостиной, ванной комнаты. Потолки могут быть
	двух типов: <a href="http://ru.wikipedia.org/wiki/Поливинилхлорид">ПВХ</a> и <a href="https://ru.wikipedia.org/wiki/Натяжной_потолок#.D0.A2.D0.BA.D0.B0.D0.BD.D0.B5.D0.B2.D1.8B.D0.B9_.D0.B1.D0.B5.D1.81.D1.88.D0.BE.D0.B2.D0.BD.D1.8B.D0.B9_.D0.BD.D0.B0.D1.82.D1.8F.D0.B6.D0.BD.D0.BE.D0.B9_.D0.BF.D0.BE.D1.82.D0.BE.D0.BB.D0.BE.D0.BA">тканевый</a>.
	Для обоих типов было много общего в вычислении стоимости.</p>
<p>В результате был реализован класс потолка, хранящий состояние и выполняющий вычисления, одинаковые для обоих потолков.
	Для обоих типов потолков реализовывались классы, наследуемые от этого общего класса потолка, позволяющие отразить
	особенности каждого типа.</p>

<p>Помимо прочего была разработана процедура экспорта в Excel итоговой сметы по набору потолков.</p>